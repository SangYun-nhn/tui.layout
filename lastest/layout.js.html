<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: layout.js</title>
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-fe2.css">
</head>
<body>

<div id="wrap">

    <div class="header">

        <div class="container-fluid">
            <h3><a href="index.html">API Documentation</a> <small>FE개발팀</small></h3>
        </div>

    </div>

    <div class="body">
        <div id="navigation" class="navigation"><h3>Samples</h3><ul class="list samples"><li class="item"><a href="tutorial-auto.html">기본 예제</a></li><li class="item"><a href="tutorial-three.html">3단 예제</a></li></ul><h3>Classes</h3><ul class="list classes"><li class="item" id="ne.component.Layout"><span class="title"><span class="p-item">ne.component.</span><a href="ne.component.Layout.html">Layout</a></span><span class="icon blue static">static</span><ul class="sublist methods ne.component.Layout"><span class="subtitle">Methods</span><li><a href="ne.component.Layout.html#height">height</a></li><li><a href="ne.component.Layout.html#init">init</a></li></ul></li><li class="item" id="ne.component.Layout.Group"><span class="title"><span class="p-item">ne.component.Layout.</span><a href="ne.component.Layout.Group.html">Group</a></span><span class="icon blue static">static</span><ul class="sublist members ne.component.Layout.Group"><span class="subtitle">Members</span><li><a href="ne.component.Layout.Group.html#$pool">$pool</a></li></ul><ul class="sublist division ne.component.Layout.Group"><li></li></ul><ul class="sublist methods ne.component.Layout.Group"><span class="subtitle">Methods</span><li><a href="ne.component.Layout.Group.html#add">add</a></li><li><a href="ne.component.Layout.Group.html#init">init</a></li><li><a href="ne.component.Layout.Group.html#remove">remove</a></li><li><a href="ne.component.Layout.Group.html#render">render</a></li><li><a href="ne.component.Layout.Group.html#storePool">storePool</a></li></ul></li><li class="item" id="ne.component.Layout.Guide"><span class="title"><span class="p-item">ne.component.Layout.</span><a href="ne.component.Layout.Guide.html">Guide</a></span><span class="icon blue static">static</span><ul class="sublist methods ne.component.Layout.Guide"><span class="subtitle">Methods</span><li><a href="ne.component.Layout.Guide.html#disable">disable</a></li><li><a href="ne.component.Layout.Guide.html#enable">enable</a></li><li><a href="ne.component.Layout.Guide.html#finish">finish</a></li><li><a href="ne.component.Layout.Guide.html#getScrollLeft">getScrollLeft</a></li><li><a href="ne.component.Layout.Guide.html#getScrollTop">getScrollTop</a></li><li><a href="ne.component.Layout.Guide.html#hide">hide</a></li><li><a href="ne.component.Layout.Guide.html#init">init</a></li><li><a href="ne.component.Layout.Guide.html#moveTo">moveTo</a></li><li><a href="ne.component.Layout.Guide.html#ready">ready</a></li><li><a href="ne.component.Layout.Guide.html#setContent">setContent</a></li><li><a href="ne.component.Layout.Guide.html#setMoveElement">setMoveElement</a></li><li><a href="ne.component.Layout.Guide.html#setPos">setPos</a></li><li><a href="ne.component.Layout.Guide.html#show">show</a></li></ul></li><li class="item" id="ne.component.Layout.Item"><span class="title"><span class="p-item">ne.component.Layout.</span><a href="ne.component.Layout.Item.html">Item</a></span><span class="icon blue static">static</span><ul class="sublist methods ne.component.Layout.Item"><span class="subtitle">Methods</span><li><a href="ne.component.Layout.Item.html#close">close</a></li><li><a href="ne.component.Layout.Item.html#fixTitle">fixTitle</a></li><li><a href="ne.component.Layout.Item.html#getIndex">getIndex</a></li><li><a href="ne.component.Layout.Item.html#hideTitle">hideTitle</a></li><li><a href="ne.component.Layout.Item.html#init">init</a></li><li><a href="ne.component.Layout.Item.html#open">open</a></li><li><a href="ne.component.Layout.Item.html#showTitle">showTitle</a></li><li><a href="ne.component.Layout.Item.html#toggle">toggle</a></li></ul></li></ul></div>
        <div id="main" class="main">



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
* @fileoverview Layout component
* @dependency code-snippet.js jquery.1.8.3
* @author NHN entertainment FE dev team Jein Yi(jein.yi@nhnent.com)
*/
ne.util.defineNamespace('ne.component');

/**
 * Layout class(ne.component.Layout) make layout element(JQueryObject) and include groups, control item move and set events.
 * @constructor
 */
ne.component.Layout = ne.util.defineClass(/**@lends ne.component.Layout.prototype */{
	/**
	 * Initialize layout
	 * @param {object} opitons
	 * 	@param {array} options.grouplist The list of group options
	 * @param {JQueryObject} $element
	 */
	init: function(opitons, $element) {
		this.$element = $element;
		this._makeGroup(opitons.grouplist);
		this._makeGuide(opitons.guideHTML);
		this._setEvents();
	},

	/**
	 * Make group
	 * @param {array} grouplist The list of group options
	 * @private
	 */
	_makeGroup: function(grouplist) {
		var group;
		this.groups = {};

		ne.util.forEach(grouplist, function(item) {
			group = this.groups[item.id] = new ne.component.Layout.Group(item);
			this.$element.append(group.$element);
		}, this);
	},

	/**
	 * Get group item
	 * @param {(string|object)} group The item ID or information to find group
	 * @returns {*}
	 * @private
	 */
	_getGroup: function(group) {
		if (ne.util.isObject(group)) {
			if (group.attr('data-group')) {
				group = group.attr('data-group');
			} else {
				group = group.parent().attr('data-group');
			}
		}
		return this.groups[group];
	},

	/**
	 * Make guide object
	 * @param {string} [guideHTML] guide The html will be usded to make guide element
	 * @private
	 */
	_makeGuide: function(guideHTML) {
		this._guide = new ne.component.Layout.Guide({
			guideHTML: guideHTML
		});
	},

	/**
	 * Set Events
	 * @private
	 */
	_setEvents: function() {
		this.onMouseDown = $.proxy(this._onMouseDown, this);
		this.onMouseMove = $.proxy(this._onMouseMove, this);
		this.onMouseUp = $.proxy(this._onMouseUp, this);
		$('.drag-item-move').on('mousedown', this.onMouseDown);
	},

	/**
	 * Mouse down event handler
	 * @param e
	 * @private
	 */
	_onMouseDown: function(e) {
		var $doc = $(document);
		this.height($doc.height());
		this._setGuide(e.target, e.clientX, e.clientY);
		$doc.on('mousemove', this.onMouseMove);
		$doc.on('mouseup', this.onMouseUp);
	},

	/**
	 * Set guide
	 * @param {object} target The target to set guide's move-statement element
	 * @param {number} pointX The position x to set guide element left.
	 * @param {number} pointY The position y to set guide element top.
	 * @private
	 */
	_setGuide: function(target, pointX, pointY) {
		var $doc = $(document),
			initPos = {
				x: pointX + $doc.scrollLeft() + 10,
				y: pointY + $doc.scrollTop() + 10
			},
			itemId = $(target).attr('data-item'),
			$moveEl = $('#' + itemId);

		this._guide.ready(initPos, $moveEl);
		this._guide.setMoveElement($moveEl);
		this.$temp = $moveEl;
		this._lockTemp();
	},

	/**
	 * It make item element seems to be locked.
	 * @private
	 */
	_lockTemp: function() {
		var group = this._getGroup(this.$temp),
			item = group.list[this.$temp.attr('data-index')];
		this.$temp.css('opacity', '0.2');
		this.$temp.find('#' + item.contentId).css('visibility', 'hidden');
	},

	/**
	 * It make item element seems to be unlocked.
	 * @private
	 */
	_unlockTemp: function() {
		var group = this._getGroup(this.$temp),
			item = group.list[this.$temp.attr('data-index')];
		this.$temp.css('opacity', '1');
		this.$temp.find('#' + item.contentId).css('visibility', 'visible');
	},

	/**
	 * Mouse move handler
	 * @param {JqueryEvent} e JqueryEvent object
	 * @private
	 */
	_onMouseMove: function(e) {

		var parent, $doc, pointX, pointY, group;

		parent = $(e.target).parent();
		$doc = $(document);
		pointX = e.clientX + $doc.scrollLeft();
		pointY = e.clientY + $doc.scrollTop();
		group = parent.attr('data-group');

		this._setScrollState(pointX, pointY);
		this._moveGuide(pointX, pointY);

		if (group) {
			this._detectMove(parent, pointX, pointY);
		}
	},

	/**
	 * If element move over area, scroll move to show element
	 * @private
	 */
	_setScrollState: function(x, y) {
		var $doc = $(document),
			$win = $(window),
			docHeight = this.height(),
			height = $win.height(),
			top = $doc.scrollTop(),
			limit = docHeight - height;

		if (height + top &lt; y) {
			$doc.scrollTop(Math.min(top + (y - height + top), limit));
		}
	},

	/**
	 * Save document height or return height
	 * @param {number} [height] The height value to save _height feild
	 */
	height: function(height) {
		if (ne.util.isUndefined(height)) {
			return this._height;
		} else {
			this._height = height;
		}
	},
	/**
	 * Detect move with group
	 * @param {object} item compare position with
	 * @param {number} pointX The position x will be detect which element selected.
	 * @param {number} pointY The position y will be detect which element selected.
	 * @private
	 */
	_detectMove: function(item, pointX, pointY) {
		var $doc = $(document),
			groupInst = this._getGroup(item),
			group = item.attr('data-group'),
			$before,
			top = $doc.scrollTop(),
			left = $doc.scrollLeft();

		if (ne.util.isEmpty(groupInst.list)) {
			item.append(this.$temp);
			this.height($doc.height());
			this.$temp.way = 'after';
			this.$temp.index = 0;
		} else {
			$before = this._detectTargetByPosition({
				x: pointX + left,
				y: pointY + top
			}, groupInst);

			if ($before &amp;&amp; $before.way) {
				$before[$before.way](this.$temp);
				this.height($doc.height());
				this.$temp.way = $before.way;
				this.$temp.index = $before.attr('data-index');
			}
		}
	},

	/**
	 * Move helper object
	 * @param {number} x move position x
	 * @param {number} y move position y
	 * @private
	 */
	_moveGuide: function(x, y) {
		this._guide.moveTo({
			x: x + 10 + 'px',
			y: y + 10 + 'px'
		});
	},

	/**
	 * Detect target by move element position
	 * @param {object} pos The position to detect
	 * @param {object} group The group that has child items
	 * @returns {string|*}
	 * @private
	 */
	_detectTargetByPosition: function(pos, group) {
		var target;

		ne.util.forEach(group.list, function(item) {
			if (!this._isValidItem(item)) {
				return;
			}
			target = this._getTarget(item, pos, group) || target;
		}, this);

		return target;
	},

	/**
	 * Get target element
	 * @param {object} item The item to compare with pos
	 * @param {object} pos The pos to figure whether target or not
	 * @param {object} group The group has item
	 * @private
	 */
	_getTarget: function(item, pos, group) {
		var bound = item.$element.offset(),
			bottom = this._getBottom(item, group),
			height = item.$element.height(),
			top = $(document).scrollTop() + bound.top,
			$target;
		if (pos.y > top &amp;&amp; pos.y &lt;= top + (height / 2)) {
			$target = item.$element;
			$target.way = 'before';
		} else if (pos.y > top + (height / 2) &amp;&amp; pos.y &lt; bottom) {
			$target = item.$element;
			$target.way = 'after';
		}

		return $target;
	},

	/**
	 * Check whether Vaild item or not
	 * @param {param} item The item To be compared with temp.
	 * @returns {boolean}
	 * @private
	 */
	_isValidItem: function(item) {
		return (item.$element[0] !== this.$temp[0]);
	},

	/**
	 * If next element exist, set bottom next element's top position, else set bottom limit(group element's bottom position) position
	 * @param {object} item The object to figure bottom position
	 * @param {object} group The group to figure bottom position
	 * @returns {*}
	 * @private
	 */
	_getBottom: function(item, group) {
		var $next = item.$element.next(),
			bottom,
			$doc = $(document),
			gbound = group.$element.offset(),
			limit = $doc.scrollTop() + gbound.top + group.$element.height();
		if ($next.hasClass(DIMMED_LAYER_CLASS)) {
			bottom = limit;
		} else {
			bottom = $doc.scrollTop() + $next.offset().top;
		}
		return bottom;
	},

	/**
	 * Get add index by $temp, $temp.way
	 * @returns {Number}
	 * @private
	 */
	_getAddIndex: function() {
		var temp = this.$temp,
			index = parseInt(temp.index, 10);
		if (temp.way === 'after') {
			index += 1;
		}
		return index;
	},

	/**
	 * Mouse up handler
	 * @param {JqueryEvent} e A event object
	 * @private
	 */
	_onMouseUp: function(e) {
		var drag = this._guide,
			$doc = $(document),
			group = this._getGroup(this.$temp.attr('data-groupInfo')),
			$target = this._detectTargetByPosition({
				x: e.clientX + $doc.scrollLeft(),
				y: e.clientY + $doc.scrollTop()
			}, group);

		this._update();
		this._unlockTemp();
		drag.finish();

		$doc.off('mousemove', this.onMouseMove);
		$doc.off('mouseup', this.onMouseUp);
	},

	/**
	 * Update groups
	 * @private
	 */
	_update: function() {
		var temp = this.$temp,
			oldGroup = this._getGroup(temp.attr('data-groupInfo')),
			targetGroup = this._getGroup(temp.parent()),
			removeIndex = parseInt(temp.attr('data-index'), 10),
			addIndex = this._getAddIndex(),
			item = oldGroup.list[removeIndex];

		if (!isNaN(addIndex)) {
			oldGroup.storePool();
			targetGroup.storePool();
			oldGroup.remove(removeIndex);
			targetGroup.add(item, addIndex);
			targetGroup.render();
			oldGroup.render();
		}
	}
});</code></pre>
        </article>
    </section>



</div>
        <div class="clearfix"></div>
    </div>

</div>
<script>
(function() {
// 영역 height 설정
var height = (window.innerHeight || document.documentElement.clientHeight || document.getElementByTagName('body')[0].clientHeight) - 50;
var navigation = document.getElementById('navigation');
var main = document.getElementById('main');
navigation.style.height = height + 'px';
main.style.height = height + 'px';

// IE 7,8을 위한 getElementsByClassName 구현
var getElementsByClassName = function(className, parentElement) {
	if(document.getElementsByClassName) {
		return (parentElement || document).getElementsByClassName(className);
	}

    var regEx = new RegExp('(^| )'+className+'( |$)');
	var nodes = new Array();
    var elements = (parentElement || document.body).getElementsByTagName("*");
    for(var i = 0, len = elements.length; i < len ; i++) {
        if(regEx.test(elements[i].className)) {
			nodes.push(elements[i]);
		}
	}
	elements = null;
    return nodes;
}

// url 파싱후 해당 카테고리만 display:block 처리
var url = location.href;
var path = url.lastIndexOf('/');
var fileName = url.substring(path+1);
var fullName = fileName.split('.');
fullName.length -= 1;
fullName = fullName.join('.');
fullName = fullName.split('-');
fullName = fullName[fullName.length - 1];
var lnbList = getElementsByClassName(fullName);
if(lnbList.length && lnbList.length > 0) {
    for(var i = 0, len = lnbList.length; i < len; i++) {
        lnbList[i].className += ' selected';
    }
}

var title = document.getElementById(fullName);
if(title) {
    title.className += ' selected';
    title.innerHTML = '<span class="arrow">▶</span>' + title.innerHTML;

    var static = getElementsByClassName('static', title);
    if(static) {
        static[0].className += ' selected';
    }
}
})();
</script>
<script type="text/javascript" src="scripts/prettify/prettify.js"></script>
<script type="text/javascript" src="scripts/prettify/lang-css.js"></script>
<script type="text/javascript">prettyPrint();</script>
<script type="text/javascript" src="scripts/linenumber.js"></script>
</body>
</html>
